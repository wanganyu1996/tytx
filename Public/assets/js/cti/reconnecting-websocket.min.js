function ReconnectingWebSocket(E){function F(G){D=new WebSocket(E);if(C.debug||ReconnectingWebSocket.debugAll){console.debug("ReconnectingWebSocket","attempt-connect",E)}var H=D;var I=setTimeout(function(){if(C.debug||ReconnectingWebSocket.debugAll){console.debug("ReconnectingWebSocket","connection-timeout",E)}B=true;H.close();B=false},C.timeoutInterval);D.onopen=function(J){clearTimeout(I);if(C.debug||ReconnectingWebSocket.debugAll){console.debug("ReconnectingWebSocket","onopen",E)}C.readyState=WebSocket.OPEN;G=false;C.onopen(J)};D.onclose=function(J){clearTimeout(I);D=null;if(A){C.readyState=WebSocket.CLOSED;C.onclose(J)}else{C.readyState=WebSocket.CONNECTING;if(!G&&!B){if(C.debug||ReconnectingWebSocket.debugAll){console.debug("ReconnectingWebSocket","onclose",E)}C.onclose(J)}setTimeout(function(){F(true)},C.reconnectInterval)}};D.onmessage=function(J){if(C.debug||ReconnectingWebSocket.debugAll){console.debug("ReconnectingWebSocket","onmessage",E,J.data)}C.onmessage(J)};D.onerror=function(J){if(C.debug||ReconnectingWebSocket.debugAll){console.debug("ReconnectingWebSocket","onerror",E,J)}if(C.readyState==WebSocket.CONNECTING&&navigator.appName!="Netscape"){clearTimeout(I);J=null;if(A){C.readyState=WebSocket.CLOSED;C.onclose(H)}else{C.readyState=WebSocket.CONNECTING;if(!G&&!B){if(C.debug||ReconnectingWebSocket.debugAll){console.debug("ReconnectingWebSocket","onclose",E)}C.onclose(H)}setTimeout(function(){F(true)},C.reconnectInterval)}}}}this.debug=false;this.reconnectInterval=1000;this.timeoutInterval=2000;var C=this;var D;var A=false;var B=false;this.url=E;this.readyState=WebSocket.CONNECTING;this.URL=E;this.onopen=function(G){};this.onclose=function(G){};this.onmessage=function(G){};this.onerror=function(G){};F(E);this.send=function(G){if(D){if(C.debug||ReconnectingWebSocket.debugAll){console.debug("ReconnectingWebSocket","send",E,G)}return D.send(G)}else{throw"INVALID_STATE_ERR : Pausing to reconnect websocket"}};this.close=function(){if(D){A=true;D.close()}};this.refresh=function(){if(D){D.close()}}}ReconnectingWebSocket.debugAll=false;