TabPanel=function(A){this.renderTo=A.renderTo||$(document.body);this.border=A.border;this.render=typeof this.renderTo=="string"?$("#"+this.renderTo):this.renderTo;this.widthResizable=A.widthResizable;this.heightResizable=A.heightResizable;this.autoResizable=A.autoResizable?true:false;this.width=A.width||"100%";this.height=A.height||"100%";this.items=A.items;this.active=A.active||0;this.tabs=[];this.scrolled=false;this.tabWidth=110+4;this.fixNum=2;this.scrollFinish=true;this.maxLength=A.maxLength||-1;this.maxzindex=0;this.init()};TabPanel.prototype={init:function(){var A=this;if(this.autoResizable){this.widthResizable=this.heightResizable=true;this.render.css("overflow","hidden");$(window).resize(function(){window.setTimeout(function(){A.resize()},200)})}this.render.width(this.width+5);this.render.height(this.height);var D=this.border!="none"?2:0;this.tabpanel=$("<DIV></DIV>");this.tabpanel.addClass("tabpanel");this.tabpanel.width("this.render.width()-hwFix");this.tabpanel.height(this.render.height()-D);this.render.append(this.tabpanel);this.tabpanel_tab_content=$("<DIV></DIV>");this.tabpanel_tab_content.addClass("tabpanel_tab_content");this.tabpanel_tab_content.appendTo(this.tabpanel);this.tabpanel_left_scroll=$("<DIV></DIV>");this.tabpanel_left_scroll.bind("click",function(){A.moveLeft()});this.tabpanel_left_scroll.addClass("tabpanel_left_scroll");this.tabpanel_left_scroll.addClass("display_none");this.tabpanel_left_scroll.bind("mouseover",function(){var F=$(this);F.addClass("tabpanel_scroll_over");F.bind("mouseout",function(){F.unbind("mouseout");F.removeClass("tabpanel_scroll_over")})});this.tabpanel_left_scroll.appendTo(this.tabpanel_tab_content);this.tabpanel_right_scroll=$("<DIV></DIV>");this.tabpanel_right_scroll.bind("click",function(){A.moveRight()});this.tabpanel_right_scroll.addClass("tabpanel_right_scroll");this.tabpanel_right_scroll.addClass("display_none");this.tabpanel_right_scroll.bind("mouseover",function(){var F=$(this);F.addClass("tabpanel_scroll_over");F.bind("mouseout",function(){F.unbind("mouseout");F.removeClass("tabpanel_scroll_over")})});this.tabpanel_right_scroll.appendTo(this.tabpanel_tab_content);this.tabpanel_move_content=$("<DIV></DIV>");this.tabpanel_move_content.addClass("tabpanel_move_content");this.tabpanel_move_content.appendTo(this.tabpanel_tab_content);this.tabpanel_mover=$("<UL></UL>");this.tabpanel_mover.addClass("tabpanel_mover");this.tabpanel_mover.appendTo(this.tabpanel_move_content);this.tabpanel_tab_spacer=$("<DIV></DIV>");this.tabpanel_tab_spacer.addClass("tabpanel_tab_spacer");this.tabpanel_tab_spacer.appendTo(this.tabpanel_tab_content);this.tabpanel_content=$("<DIV></DIV>");this.tabpanel_content.addClass("tabpanel_content");this.tabpanel_content.appendTo(this.tabpanel);var E=this.tabpanel.width();var B=this.tabpanel.height();if(this.border=="none"){this.tabpanel.css("border","none")}this.tabpanel_content.height(B-this.tabpanel_tab_content.get(0).offsetHeight);this.update();for(var C=0;C<this.items.length;C++){this.items[C].notExecuteMoveSee=true;this.addTab(this.items[C])}if(this.active>=0){this.show(this.active,false)}},moveLeft:function(){if(this.scrollFinish){this.disableScroll();this.scrollFinish=false;Fader.apply(this,new Array({element:this.tabpanel_mover,style:"marginLeft",num:this.tabWidth,maxMove:this.maxMove,onFinish:this.useableScroll}));this.run()}},moveRight:function(){if(this.scrollFinish){this.disableScroll();this.scrollFinish=false;Fader.apply(this,new Array({element:this.tabpanel_mover,style:"marginLeft",num:this.tabWidth*-1,maxMove:this.maxMove,onFinish:this.useableScroll}));this.run()}},moveToLeft:function(){if(this.scrolled&&this.scrollFinish){this.disableScroll();this.scrollFinish=false;var A=parseInt(this.tabpanel_mover.css("marginLeft"))*-1;Fader.apply(this,new Array({element:this.tabpanel_mover,style:"marginLeft",num:A,maxMove:this.maxMove,interval:20,step:(A/10)<10?10:A/10,onFinish:this.useableScroll}));this.run()}},moveToRight:function(){if(this.scrolled&&this.scrollFinish){this.disableScroll();this.scrollFinish=false;var B=parseInt(this.tabpanel_mover.css("marginLeft"))*-1;var D=this.tabpanel_mover.children().length*this.tabWidth;var A=this.tabpanel_move_content.width();var C=(D-A-B+this.fixNum)*-1;Fader.apply(this,new Array({element:this.tabpanel_mover,style:"marginLeft",num:C,maxMove:this.maxMove,step:(C*-1/10)<10?10:C*-1/10,onFinish:this.useableScroll}));this.run()}},moveToSee:function(C){if(this.scrolled){var A=this.tabWidth*C;var D=parseInt(this.tabpanel_mover.css("marginLeft"));var B;if(D<=0){B=(D+A)*-1;if(((B+D)*-1)>=this.maxMove){this.moveToRight()}else{this.disableScroll();this.scrollFinish=false;Fader.apply(this,new Array({element:this.tabpanel_mover,style:"marginLeft",num:B,maxMove:this.maxMove,step:(B/10)<10?10:B/10,onFinish:this.useableScroll}));this.run()}}else{B=(A-D)*-1;if((B*-1)>=this.maxMove){this.moveToRight()}else{this.disableScroll();this.scrollFinish=false;Fader.apply(this,new Array({element:this.tabpanel_mover,style:"marginLeft",num:B,maxMove:this.maxMove,onFinish:this.useableScroll}));this.run()}}}},disableScroll:function(){this.tabpanel_left_scroll.addClass("tabpanel_left_scroll_disabled");this.tabpanel_left_scroll.attr("disabled",true);this.tabpanel_right_scroll.addClass("tabpanel_right_scroll_disabled");this.tabpanel_right_scroll.attr("disabled",true)},useableScroll:function(){var A=this;if(this.scrolled){if(parseInt(A.tabpanel_mover.css("marginLeft"))==0){A.tabpanel_left_scroll.addClass("tabpanel_left_scroll_disabled");A.tabpanel_left_scroll.attr("disabled",true);A.tabpanel_right_scroll.removeClass("tabpanel_right_scroll_disabled");A.tabpanel_right_scroll.removeAttr("disabled")}else{if(parseInt(A.tabpanel_mover.css("marginLeft"))*-1==A.maxMove){A.tabpanel_left_scroll.removeClass("tabpanel_left_scroll_disabled");A.tabpanel_left_scroll.removeAttr("disabled",true);A.tabpanel_right_scroll.addClass("tabpanel_right_scroll_disabled");A.tabpanel_right_scroll.attr("disabled")}else{A.tabpanel_left_scroll.removeClass("tabpanel_left_scroll_disabled");A.tabpanel_left_scroll.removeAttr("disabled",true);A.tabpanel_right_scroll.removeClass("tabpanel_right_scroll_disabled");A.tabpanel_right_scroll.removeAttr("disabled")}}}A.scrollFinish=true},update:function(){var A=this.tabpanel_tab_content.width();if(this.scrolled){A-=(this.tabpanel_left_scroll.width()+this.tabpanel_right_scroll.width())}this.tabpanel_move_content.width(A);this.maxMove=(this.tabpanel_mover.children().length*this.tabWidth)-A+this.fixNum},showScroll:function(){var B=this.tabpanel_mover.children().length*this.tabWidth;var A=this.tabpanel_tab_content.width();if(B>A&&!this.scrolled){this.tabpanel_move_content.addClass("tabpanel_move_content_scroll");this.tabpanel_left_scroll.removeClass("display_none");this.tabpanel_right_scroll.removeClass("display_none");this.scrolled=true}else{if(B<A&&this.scrolled){this.moveToLeft();this.tabpanel_move_content.removeClass("tabpanel_move_content_scroll");this.tabpanel_left_scroll.addClass("display_none");this.tabpanel_right_scroll.addClass("display_none");this.scrolled=false;this.scrollFinish=true}}},addTab:function(F){if(this.maxLength!=-1&&this.maxLength<=this.tabs.length){return false}F.id=F.id||Math.uuid();if($("#"+F.id).length>0){this.show(F.id,false)}else{if(this.scrollFinish){var C=this;var E=$("<LI></LI>");E.attr("id",F.id);E.appendTo(this.tabpanel_mover);var G=$("<DIV></DIV>");G.text(F.title);G.appendTo(E);var H=F.closable==false?0:5;if(F.icon){G.addClass("icon_title");G.css("background-image",'url("'+F.icon+'")');if(G.width()>(this.tabWidth-35-H)){G.width((this.tabWidth-50-H));G.attr("title",F.title);E.append("<DIV>...</DIV>")}}else{G.addClass("title");if(G.width()>(this.tabWidth-19-H)){G.width((this.tabWidth-30-H));G.attr("title",F.title);E.append("<DIV>...</DIV>")}}var D=$("<DIV></DIV>");D.addClass("closer");D.attr("title","Close tab");D.appendTo(E);var I=$("<DIV></DIV>");I.addClass("html_content");I.appendTo(this.tabpanel_content);var A=I.find("iframe");var B=this.tabpanel_mover.children().index(this.tabpanel_mover.find(".active")[0]);if(B<0){B=0}if(this.tabs.length>B){F.preTabId=this.tabs[B].id}else{F.preTabId=""}F.tab=E;F.title=G;F.closer=D;F.content=I;F.disable=F.disable==undefined?false:F.disable;F.closable=F.closable==undefined?true:F.closable;if(F.closable==false){D.addClass("display_none")}if(F.disabled==true){E.attr("disabled",true);G.addClass(".disabled")}this.tabs.push(F);E.bind("click",function(J){return function(){C.show(J,false)}}(this.tabs.length-1));D.bind("click",function(J){return function(){C.kill(J);monitor()}}(this.tabs.length-1));if(!F.lazyload){this.show(this.tabs.length-1,F.notExecuteMoveSee)}this.update();if(!F.lazyload&&!F.notExecuteMoveSee){this.moveToRight()}}}},getTabPosision:function(B){if(typeof B=="string"){for(var A=0;A<this.tabs.length;A++){if(B==this.tabs[A].id){B=A;break}}}return B},refresh:function(C){C=this.getTabPosision(C);if(typeof C=="string"){return false}else{var B=this.tabs[C].content.find("iframe");if(B.length>0){for(var A=0;A<B.length;A++){if(B[0].id!="callIframeNumber"){B[0].contentWindow.location.reload()}}}}},iterateFlush:function(C){if(C.window.frames.length>0){for(var A=0;A<C.window.frames.length;A++){this.iterateFlush(C.window.frames[A])}}else{if(C.document.forms.length>0){for(var A=0;A<C.document.forms.length;A++){try{C.document.forms[A].submit()}catch(B){C.location.reload()}}}else{C.location.reload()}}},show:function(A,B){if(this.tabs.length<1){return false}A=this.getTabPosision(A);if(typeof A=="string"){A=0}if(this.scrollFinish){if(A>=this.tabs.length){A=0}this.tabs[A].content.css("z-index",++this.maxzindex);if(this.tabs[A].tab.hasClass("active")){if(!B){this.moveToSee(A)}}else{if(this.tabs[A].content.html()==""){this.tabs[A].content.html(this.tabs[A].html)}this.tabpanel_mover.find(".active").removeClass("active");this.tabs[A].tab.addClass("active");if(!B){this.moveToSee(A)}}}},kill:function(D){var A=this;D=this.getTabPosision(D);var B=this.tabs[D].preTabId;this.tabs[D].closer.remove();this.tabs[D].title.remove();this.tabs[D].tab.remove();this.tabs[D].content.remove();this.tabs.splice(D,1);for(var C=0;C<this.tabs.length;C++){this.tabs[C].tab.unbind("click");this.tabs[C].tab.bind("click",function(E){return function(){A.show(E,false)}}(C));this.tabs[C].closer.unbind("click");this.tabs[C].closer.bind("click",function(E){return function(){A.kill(E)}}(C));if(this.tabs[C].closable){this.tabs[C].tab.unbind("dblclick");this.tabs[C].tab.bind("dblclick",function(E){return function(){A.kill(E)}}(C))}}this.update();this.show(B,false)},getTabsCount:function(){return this.tabs.length},setTitle:function(A,B){A=this.getTabPosision(A);if(A<this.tabs.length){this.tabs[A].title.text(B)}},getTitle:function(A){A=this.getTabPosision(A);return this.tabs[A].title.text()},setContent:function(A,B){A=this.getTabPosision(A);if(A<this.tabs.length){this.tabs[A].content.html(B)}},getContent:function(A){A=this.getTabPosision(A);return this.tabs[A].content.html()},setDisable:function(B,A){B=this.getTabPosision(B);if(B<this.tabs.length){this.tabs[B].disable=A;if(A){this.tabs[B].tab.attr("disabled",true);this.tabs[B].title.addClass(".disabled")}else{this.tabs[B].tab.removeAttr("disabled");this.tabs[B].title.removeClass(".disabled")}}},getDisable:function(A){A=this.getTabPosision(A);return this.tabs[A].disable},setClosable:function(A,B){A=this.getTabPosision(A);if(A<this.tabs.length){this.tabs[A].closable=B;if(B){this.tabs[A].closer.addClass("display_none")}else{this.tabs[A].closer.addClass("closer");this.tabs[A].closer.removeClass("display_none")}}},getClosable:function(A){A=this.getTabPosision(A);return this.tabs[A].closable},getActiveIndex:function(){return this.tabpanel_mover.children().index(this.tabpanel_mover.find(".active")[0])},getActiveTab:function(){var A=this.tabpanel_mover.children().index(this.tabpanel_mover.find(".active")[0]);if(this.tabs.length>A){return this.tabs[A]}else{return null}},resize:function(){var A=this.border=="none"?0:2;if(this.widthResizable){this.width=this.render.width();this.tabpanel.width(this.width-A);this.tabpanel_tab_content.width(this.width-A);this.tabpanel_content.width(this.width-A)}if(this.heightResizable){this.height=this.render.height();this.tabpanel.height(this.height-A);this.tabpanel_content.height(this.height-this.tabpanel_tab_content.get(0).offsetHeight)}this.useableScroll();this.update();var B=this;setTimeout(function(){B.moveToSee(B.getActiveIndex())},200)},};