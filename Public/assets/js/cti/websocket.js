if(window.MozWebSocket){window.WebSocket=window.MozWebSocket}var ws={WS_OPEN:1,WS_CLOSING:2,WS_CLOSED:3,MSG_WS_NOT_SUPPORTED:"Unfortunately your browser does neither natively support WebSockets\nnor you have the Adobe Flash-PlugIn 10+ installed.\nPlease download the last recent Adobe Flash Player at http://get.adobe.com/flashplayer.",WS_SERVER_SCHEMA:"ws",WS_SERVER_HOST:(self.location.hostname?self.location.hostname:"127.0.0.1"),WS_SERVER_PORT:8787,WS_SERVER_CONTEXT:"/webSocket",WS_SERVER_URL:"ws://"+(self.location.hostname?self.location.hostname:"127.0.0.1")+":8787/webSocket",BT_UNKNOWN:0,BT_FIREFOX:1,BT_NETSCAPE:2,BT_OPERA:3,BT_IEXPLORER:4,BT_SAFARI:5,BT_CHROME:6,BROWSER_NAMES:["Unknown","Firefox","Netscape","Opera","Internet Explorer","Safari","Chrome"],$:function(A){return document.getElementById(A)},getServerURL:function(A,C,D,E){var B=A+"://"+C+(D?":"+D:"");if(E&&E.length>0){B+=E}return B},browserSupportsWebSockets:function(){return(window.WebSocket!==null&&window.WebSocket!==undefined)},browserSupportsNativeWebSockets:(function(){return(window.WebSocket!==null&&window.WebSocket!==undefined)})(),browserSupportsJSON:function(){return(window.JSON!==null&&window.JSON!==undefined)},browserSupportsNativeJSON:(function(){return(window.JSON!==null&&window.JSON!==undefined)})(),browserSupportsWebWorkers:(function(){return(window.Worker!==null&&window.Worker!==undefined)})(),isIE:(function(){var A=navigator.userAgent;var B=A.indexOf("MSIE");return(B>=0)})(),getBrowserName:function(){return this.fBrowserName},getBrowserVersion:function(){return this.fBrowserVerNo},getBrowserVersionString:function(){return this.fBrowserVerStr},isFirefox:function(){return this.fIsFirefox},isOpera:function(){return this.fIsOpera},isChrome:function(){return this.fIsChrome},isIExplorer:function(){return this.fIsIExplorer},isIE_LE6:function(){return(this.isIExplorer()&&this.getBrowserVersion()<7)},isIE_LE7:function(){return(this.isIExplorer()&&this.getBrowserVersion()<8)},isIE_GE8:function(){return(this.isIExplorer()&&this.getBrowserVersion()>=8)},isSafari:function(){return this.fIsSafari},isNetscape:function(){return this.fIsNetscape},isPocketIE:function(){return this.fIsPocketIE},isConnected:function(){return(this.isOpened())},isOpened:function(){return(this.fConn!=undefined&&this.fConn!=null&&this.fConn.readyState==ws.WS_OPEN)}};(function(){ws.fBrowserName="unknown";ws.fBrowserType=ws.BT_UNKNOWN;ws.fBrowserVerNo=undefined;ws.fIsIExplorer=false;ws.fIsFirefox=false;ws.fIsChrome=false;var D=navigator.userAgent;ws.fIsChrome=D.indexOf("Chrome")>=0;if(ws.fIsChrome){ws.fBrowserType=ws.BT_CHROME}else{ws.fIsFirefox=navigator.appName=="Netscape";if(ws.fIsFirefox){ws.fBrowserType=ws.BT_FIREFOX}else{ws.fIsIExplorer=navigator.appName=="Microsoft Internet Explorer";if(ws.fIsIExplorer){ws.fBrowserType=ws.BT_IEXPLORER}}}var C,A;var B;var E;var F;if(ws.fIsIExplorer){ws.fBrowserName=ws.BROWSER_NAMES[ws.BT_IEXPLORER];F=D.match(/MSIE.*/i);if(F){B=F[0].substr(5);C=B.indexOf(";");ws.fBrowserVerStr=C>0?B.substr(0,C):B;ws.fBrowserVerNo=parseFloat(ws.fBrowserVerStr)}}else{if(ws.fIsFirefox){ws.fBrowserName=ws.BROWSER_NAMES[ws.BT_FIREFOX];F=D.match(/Firefox\/.*/i);if(F){B=F[0].substr(8);C=B.indexOf(" ");if(C>0){ws.fBrowserVerStr=B.substring(0,C)}else{ws.fBrowserVerStr=B}E=0;A=0;while(A<B.length){if(B.charAt(A)=="."){E++}if(E>=2){break}A++}B=B.substring(0,A);ws.fBrowserVerNo=parseFloat(B)}}else{if(ws.fIsChrome){ws.fBrowserName=ws.BROWSER_NAMES[ws.BT_CHROME];F=D.match(/Chrome\/.*/i);if(F){B=F[0].substr(7);C=B.indexOf(" ");ws.fBrowserVerStr=C>0?B.substr(0,C):B;ws.fBrowserVerNo=parseFloat(B)}}}}}());ws.oop={};ws.oop.declareClass=function(D,F,C,E){var A=self[D];if(!A){self[D]={}}var H=function(){if(this.create){this.create.apply(this,arguments)}};A[F]=H;var G;for(G in E){H.prototype[G]=E[G]}if(C!=null){if(!C.descendants){C.descendants=[]}C.descendants.push(H);for(G in C.prototype){var B=C.prototype[G];if(typeof B=="function"){if(H.prototype[G]){H.prototype[G].inherited=B}else{H.prototype[G]=B}H.prototype[G].superClass=C}}}};ws.oop.addPlugIn=function(B,D){if(!B.fPlugIns){B.fPlugIns=[]}B.fPlugIns.push(D);for(var A in D){if(!B.prototype[A]){B.prototype[A]=D[A]}}if(B.descendants){for(var C=0,E=B.descendants.length;C<E;C++){ws.oop.addPlugIn(B.descendants[C],D)}}};ws.oop.declareClass("ws","webSocketBaseClient",null,{open:function(B,C){if(!C){C={}}if(self.WebSocket){if(!this.fConn){var A=this;var D=null;this.fConn=new ReconnectingWebSocket(B);this.fURL=B;this.fConn.onopen=function(E){A.fStatus=ws.WS_OPEN;if(C.OnOpen){C.OnOpen(E)}A.processQueue(C.thisDN)};this.fConn.onmessage=function(E){A.processToken(E);if(C.OnMessage){C.OnMessage(E,D)}};this.fConn.onclose=function(E){A.fStatus=ws.WS_CLOSED;if(C.OnClose){C.OnClose(E)}}}else{throw new Error("Already connected")}}else{throw new Error("WebSockets not supported by browser")}},processQueue:function(A){this.sendToken({type:"welcome",thisDN:A,message:""})},processToken:function(A){token=$.parseJSON(A.data);if(token.messageId==2){if(this.fOnWelcome){this.fOnWelcome(token)}}},sendToken:function(A){this.fConn.send($.toJSON(A))},connect:function(A,B){return this.open(A,B)},isOpened:function(){return(this.fConn!=undefined&&this.fConn!=null&&this.fConn.readyState==ws.WS_OPEN)},getURL:function(){return this.fURL},isConnected:function(){return(this.isOpened())},forceClose:function(A){},close:function(A){},disconnect:function(A){return this.close(A)},createDefaultResult:function(){return{code:0,msg:"ok"}},addPlugIn:function(A,B){if(!this.fPlugIns){this.fPlugIns=[]}this.fPlugIns.push(A);if(!B){B=A.ID}if(B){A.conn=this}}});ws.oop.declareClass("ws","webSocketClient",ws.webSocketBaseClient,{open:function(C,D){var A=this.createDefaultResult();try{if(D&&D.OnWelcome&&typeof D.OnWelcome=="function"){this.fOnWelcome=D.OnWelcome}arguments.callee.inherited.call(this,C,D)}catch(B){A.code=-1;A.msg="Exception on open: "+B.message}return A},connect:function(A,B){return this.open(A,B)},close:function(A){},disconnect:function(A){return this.close(A)}});ws.SystemClientPlugIn={login:function(B,D,C){var A=this.createDefaultResult();if(this.isOpened()){this.sendToken({type:"login",thisDN:B,message:D})}else{A.code=-1;A.msg="Not connected."}return A},logon:function(B,G,F,D){var A=this.createDefaultResult();if(!D){D={}}D.thisDN=G;if(this.isOpened()){this.login(G,F,D)}else{var E=D.OnWelcome;var C=this;D.OnWelcome=function(H){if(E){E.call(C,H)}C.login(G,F,D)};this.open(B,D)}return A},ping:function(B){var A=this.createDefaultResult();if(this.isOpened()){this.sendToken({type:"ping",thisDN:B,message:""})}else{A.code=-1;A.msg="Not connected."}return A},startKeepAlive:function(D){if(this.hKeepAlive){stopKeepAlive()}if(!this.isOpened()){return}var A=10000;var B=true;var C="";if(D){if(D.interval!=undefined){A=D.interval}if(D.immediate!=undefined){B=D.immediate}if(D.thisDN!=undefined){C=D.thisDN}}if(B){this.ping(C)}var E=this;this.hKeepAlive=setInterval(function(){if(E.isOpened()){E.ping(C)}else{E.stopKeepAlive()}},A)},stopKeepAlive:function(){if(this.hKeepAlive){clearInterval(this.hKeepAlive);this.hKeepAlive=null}}};ws.oop.addPlugIn(ws.webSocketClient,ws.SystemClientPlugIn);if(!ws.browserSupportsNativeWebSockets){var swfobject=function(){var At="undefined",Ay="object",Z="Shockwave Flash",Ad="ShockwaveFlash.ShockwaveFlash",AB="application/x-shockwave-flash",Y="SWFObjectExprInst",Aw="onreadystatechange",Al=window,AG=document,AE=navigator,Ae=false,Af=[AI],AL=[],Ak=[],Aj=[],AM,Ab,Au,Ao,Ag=false,AQ=false,AK,As,AN=true,An=function(){var B=typeof AG.getElementById!=At&&typeof AG.getElementsByTagName!=At&&typeof AG.createElement!=At,I=AE.userAgent.toLowerCase(),G=AE.platform.toLowerCase(),K=G?/win/.test(G):/win/.test(I),J=G?/mac/.test(G):/mac/.test(I),A=/webkit/.test(I)?parseFloat(I.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):false,F=!+"\v1",E=[0,0,0],D=null;if(typeof AE.plugins!=At&&typeof AE.plugins[Z]==Ay){D=AE.plugins[Z].description;if(D&&!(typeof AE.mimeTypes!=At&&AE.mimeTypes[AB]&&!AE.mimeTypes[AB].enabledPlugin)){Ae=true;F=false;D=D.replace(/^.*\s+(\S+\s+\S+$)/,"$1");E[0]=parseInt(D.replace(/^(.*)\..*$/,"$1"),10);E[1]=parseInt(D.replace(/^.*\.(.*)\s.*$/,"$1"),10);E[2]=/[a-zA-Z]/.test(D)?parseInt(D.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0}}else{if(typeof Al.ActiveXObject!=At){try{var C=new ActiveXObject(Ad);if(C){D=C.GetVariable("$version");if(D){F=true;D=D.split(" ")[1].split(",");E=[parseInt(D[0],10),parseInt(D[1],10),parseInt(D[2],10)]}}}catch(H){}}}return{w3:B,pv:E,wk:A,ie:F,win:K,mac:J}}(),AH=function(){if(!An.w3){return}if((typeof AG.readyState!=At&&AG.readyState=="complete")||(typeof AG.readyState==At&&(AG.getElementsByTagName("body")[0]||AG.body))){AR()}if(!Ag){if(typeof AG.addEventListener!=At){AG.addEventListener("DOMContentLoaded",AR,false)}if(An.ie&&An.win){AG.attachEvent(Aw,function(){if(AG.readyState=="complete"){AG.detachEvent(Aw,arguments.callee);AR()}});if(Al==top){(function(){if(Ag){return}try{AG.documentElement.doScroll("left")}catch(A){setTimeout(arguments.callee,0);return}AR()})()}}if(An.wk){(function(){if(Ag){return}if(!/loaded|complete/.test(AG.readyState)){setTimeout(arguments.callee,0);return}AR()})()}Az(AR)}}();function AR(){if(Ag){return}try{var A=AG.getElementsByTagName("body")[0].appendChild(Ap("span"));A.parentNode.removeChild(A)}catch(D){return}Ag=true;var B=Af.length;for(var C=0;C<B;C++){Af[C]()}}function Ah(A){if(Ag){A()}else{Af[Af.length]=A}}function Az(B){if(typeof Al.addEventListener!=At){Al.addEventListener("load",B,false)}else{if(typeof AG.addEventListener!=At){AG.addEventListener("load",B,false)}else{if(typeof Al.attachEvent!=At){AJ(Al,"onload",B)}else{if(typeof Al.onload=="function"){var A=Al.onload;Al.onload=function(){A();B()}}else{Al.onload=B}}}}}function AI(){if(Ae){Ac()}else{Ai()}}function Ac(){var B=AG.getElementsByTagName("body")[0];var D=Ap(Ay);D.setAttribute("type",AB);var A=B.appendChild(D);if(A){var C=0;(function(){if(typeof A.GetVariable!=At){var E=A.GetVariable("$version");if(E){E=E.split(" ")[1].split(",");An.pv=[parseInt(E[0],10),parseInt(E[1],10),parseInt(E[2],10)]}}else{if(C<10){C++;setTimeout(arguments.callee,10);return}}B.removeChild(D);A=null;Ai()})()}else{Ai()}}function Ai(){var A=AL.length;if(A>0){for(var L=0;L<A;L++){var F=AL[L].id;var D=AL[L].callbackFn;var B={success:false,id:F};if(An.pv[0]>0){var K=AP(F);if(K){if(Ar(AL[L].swfVersion)&&!(An.wk&&An.wk<312)){AD(F,true);if(D){B.success=true;B.ref=Av(F);D(B)}}else{if(AL[L].expressInstall&&Aq()){var I={};I.data=AL[L].expressInstall;I.width=K.getAttribute("width")||"0";I.height=K.getAttribute("height")||"0";if(K.getAttribute("class")){I.styleclass=K.getAttribute("class")}if(K.getAttribute("align")){I.align=K.getAttribute("align")}var H={};var E=K.getElementsByTagName("param");var J=E.length;for(var C=0;C<J;C++){if(E[C].getAttribute("name").toLowerCase()!="movie"){H[E[C].getAttribute("name")]=E[C].getAttribute("value")}}Aa(I,H,F,D)}else{AA(K);if(D){D(B)}}}}}else{AD(F,true);if(D){var G=Av(F);if(G&&typeof G.SetVariable!=At){B.success=true;B.ref=G}D(B)}}}}}function Av(D){var B=null;var C=AP(D);if(C&&C.nodeName=="OBJECT"){if(typeof C.SetVariable!=At){B=C}else{var A=C.getElementsByTagName(Ay)[0];if(A){B=A}}}return B}function Aq(){return !AQ&&Ar("6.0.65")&&(An.win||An.mac)&&!(An.wk&&An.wk<312)}function Aa(B,C,E,D){AQ=true;Au=D||null;Ao={success:false,id:E};var H=AP(E);if(H){if(H.nodeName=="OBJECT"){AM=AS(H);Ab=null}else{AM=H;Ab=E}B.id=Y;if(typeof B.width==At||(!/%$/.test(B.width)&&parseInt(B.width,10)<310)){B.width="310"}if(typeof B.height==At||(!/%$/.test(B.height)&&parseInt(B.height,10)<137)){B.height="137"}AG.title=AG.title.slice(0,47)+" - Flash Player Installation";var A=An.ie&&An.win?"ActiveX":"PlugIn",G="MMredirectURL="+Al.location.toString().replace(/&/g,"%26")+"&MMplayerType="+A+"&MMdoctitle="+AG.title;if(typeof C.flashvars!=At){C.flashvars+="&"+G}else{C.flashvars=G}if(An.ie&&An.win&&H.readyState!=4){var F=Ap("div");E+="SWFObjectNew";F.setAttribute("id",E);H.parentNode.insertBefore(F,H);H.style.display="none";(function(){if(H.readyState==4){H.parentNode.removeChild(H)}else{setTimeout(arguments.callee,10)}})()}AF(B,C,E)}}function AA(B){if(An.ie&&An.win&&B.readyState!=4){var A=Ap("div");B.parentNode.insertBefore(A,B);A.parentNode.replaceChild(AS(B),A);B.style.display="none";(function(){if(B.readyState==4){B.parentNode.removeChild(B)}else{setTimeout(arguments.callee,10)}})()}else{B.parentNode.replaceChild(AS(B),B)}}function AS(A){var F=Ap("div");if(An.win&&An.ie){F.innerHTML=A.innerHTML}else{var E=A.getElementsByTagName(Ay)[0];if(E){var D=E.childNodes;if(D){var C=D.length;for(var B=0;B<C;B++){if(!(D[B].nodeType==1&&D[B].nodeName=="PARAM")&&!(D[B].nodeType==8)){F.appendChild(D[B].cloneNode(true))}}}}}return F}function AF(I,A,G){var F,B=AP(G);if(An.wk&&An.wk<312){return F}if(B){if(typeof I.id==At){I.id=G}if(An.ie&&An.win){var H="";for(var K in I){if(I[K]!=Object.prototype[K]){if(K.toLowerCase()=="data"){A.movie=I[K]}else{if(K.toLowerCase()=="styleclass"){H+=' class="'+I[K]+'"'}else{if(K.toLowerCase()!="classid"){H+=" "+K+'="'+I[K]+'"'}}}}}var L="";for(var C in A){if(A[C]!=Object.prototype[C]){L+='<param name="'+C+'" value="'+A[C]+'" />'}}B.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+H+">"+L+"</object>";Ak[Ak.length]=I.id;F=AP(I.id)}else{var E=Ap(Ay);E.setAttribute("type",AB);for(var J in I){if(I[J]!=Object.prototype[J]){if(J.toLowerCase()=="styleclass"){E.setAttribute("class",I[J])}else{if(J.toLowerCase()!="classid"){E.setAttribute(J,I[J])}}}}for(var D in A){if(A[D]!=Object.prototype[D]&&D.toLowerCase()!="movie"){X(E,D,A[D])}}B.parentNode.replaceChild(E,B);F=E}}return F}function X(A,B,C){var D=Ap("param");D.setAttribute("name",B);D.setAttribute("value",C);A.appendChild(D)}function Ax(B){var A=AP(B);if(A&&A.nodeName=="OBJECT"){if(An.ie&&An.win){A.style.display="none";(function(){if(A.readyState==4){AO(B)}else{setTimeout(arguments.callee,10)}})()}else{A.parentNode.removeChild(A)}}}function AO(A){var C=AP(A);if(C){for(var B in C){if(typeof C[B]=="function"){C[B]=null}}C.parentNode.removeChild(C)}}function AP(A){var B=null;try{B=AG.getElementById(A)}catch(C){}return B}function Ap(A){return AG.createElement(A)}function AJ(A,B,C){A.attachEvent(B,C);Aj[Aj.length]=[A,B,C]}function Ar(A){var C=An.pv,B=A.split(".");B[0]=parseInt(B[0],10);B[1]=parseInt(B[1],10)||0;B[2]=parseInt(B[2],10)||0;return(C[0]>B[0]||(C[0]==B[0]&&C[1]>B[1])||(C[0]==B[0]&&C[1]==B[1]&&C[2]>=B[2]))?true:false}function AC(B,F,E,A){if(An.ie&&An.mac){return}var G=AG.getElementsByTagName("head")[0];if(!G){return}var D=(E&&typeof E=="string")?E:"screen";if(A){AK=null;As=null}if(!AK||As!=D){var C=Ap("style");C.setAttribute("type","text/css");C.setAttribute("media",D);AK=G.appendChild(C);if(An.ie&&An.win&&typeof AG.styleSheets!=At&&AG.styleSheets.length>0){AK=AG.styleSheets[AG.styleSheets.length-1]}As=D}if(An.ie&&An.win){if(AK&&typeof AK.addRule==Ay){AK.addRule(B,F)}}else{if(AK&&typeof AG.createTextNode!=At){AK.appendChild(AG.createTextNode(B+" {"+F+"}"))}}}function AD(A,B){if(!AN){return}var C=B?"visible":"hidden";if(Ag&&AP(A)){AP(A).style.visibility=C}else{AC("#"+A,"visibility:"+C)}}function Am(C){var A=/[\\\"<>\.;]/;var B=A.exec(C)!=null;return B&&typeof encodeURIComponent!=At?encodeURIComponent(C):C}var AT=function(){if(An.ie&&An.win){window.attachEvent("onunload",function(){var B=Aj.length;for(var A=0;A<B;A++){Aj[A][0].detachEvent(Aj[A][1],Aj[A][2])}var C=Ak.length;for(var F=0;F<C;F++){Ax(Ak[F])}for(var E in An){An[E]=null}An=null;for(var D in swfobject){swfobject[D]=null}swfobject=null})}}();return{registerObject:function(A,C,E,B){if(An.w3&&A&&C){var D={};D.id=A;D.swfVersion=C;D.expressInstall=E;D.callbackFn=B;AL[AL.length]=D;AD(A,false)}else{if(B){B({success:false,id:A})}}},getObjectById:function(A){if(An.w3){return Av(A)}},embedSWF:function(I,H,J,A,F,B,D,C,K,E){var G={success:false,id:H};if(An.w3&&!(An.wk&&An.wk<312)&&I&&H&&J&&A&&F){AD(H,false);Ah(function(){J+="";A+="";var O={};if(K&&typeof K===Ay){for(var Q in K){O[Q]=K[Q]}}O.data=I;O.width=J;O.height=A;var L={};if(C&&typeof C===Ay){for(var P in C){L[P]=C[P]}}if(D&&typeof D===Ay){for(var M in D){if(typeof L.flashvars!=At){L.flashvars+="&"+M+"="+D[M]}else{L.flashvars=M+"="+D[M]}}}if(Ar(F)){var N=AF(O,L,H);if(O.id==H){AD(H,true)}G.success=true;G.ref=N}else{if(B&&Aq()){O.data=B;Aa(O,L,H,E);return}else{AD(H,true)}}if(E){E(G)}})}else{if(E){E(G)}}},switchOffAutoHideShow:function(){AN=false},ua:An,getFlashPlayerVersion:function(){return{major:An.pv[0],minor:An.pv[1],release:An.pv[2]}},hasFlashPlayerVersion:Ar,createSWF:function(A,C,B){if(An.w3){return AF(A,C,B)}else{return undefined}},showExpressInstall:function(A,D,B,C){if(An.w3&&Aq()){Aa(A,D,B,C)}},removeSWF:function(A){if(An.w3){Ax(A)}},createCSS:function(D,A,C,B){if(An.w3){AC(D,A,C,B)}},addDomLoadEvent:Ah,addLoadEvent:Az,getQueryParamValue:function(D){var A=AG.location.search||AG.location.hash;if(A){if(/\?/.test(A)){A=A.split("?")[1]}if(D==null){return Am(A)}var C=A.split("&");for(var B=0;B<C.length;B++){if(C[B].substring(0,C[B].indexOf("="))==D){return Am(C[B].substring((C[B].indexOf("=")+1)))}}}return""},expressInstallCallback:function(){if(AQ){var A=AP(Y);if(A&&AM){A.parentNode.replaceChild(AM,A);if(Ab){AD(Ab,true);if(An.ie&&An.win){AM.style.display="block"}}if(Au){Au(Ao)}}AQ=false}}}}();if(swfobject.hasFlashPlayerVersion("10.0.0")){WEB_SOCKET_DEBUG=true;(function(){var D=document.getElementsByTagName("script");for(var F=0,B=D.length;F<B;F++){var A=D[F];var E=A.src;if(!E){E=A.getAttribute("src")}if(E){var C=E.lastIndexOf("websocket.js");if(C>0){window.WEB_SOCKET_SWF_LOCATION=E.substr(0,C)+"flash-bridge/WebSocketMain.swf";ws.WS_FLASHBRIDGE=window.WEB_SOCKET_SWF_LOCATION;break}}}})();if(window.WEB_SOCKET_SWF_LOCATION){(function(){if(window.WEB_SOCKET_FORCE_FLASH){}else{if(window.WebSocket){return}else{if(window.MozWebSocket){window.WebSocket=MozWebSocket;return}}}var A;if(window.WEB_SOCKET_LOGGER){A=WEB_SOCKET_LOGGER}else{if(window.console&&window.console.log&&window.console.error){A=window.console}else{A={log:function(){},error:function(){}}}}if(swfobject.getFlashPlayerVersion().major<10){A.error("Flash Player >= 10.0.0 is required.");return}if(location.protocol=="file:"){A.error("WARNING: web-socket-js doesn't work in file:///... URL unless you set Flash Security Settings properly. Open the page via Web server i.e. http://...")}window.WebSocket=function(C,E,D,F,B){var G=this;G.__id=WebSocket.__nextId++;WebSocket.__instances[G.__id]=G;G.readyState=WebSocket.CONNECTING;G.bufferedAmount=0;G.__events={};if(!E){E=[]}else{if(typeof E=="string"){E=[E]}}G.__createTask=setTimeout(function(){WebSocket.__addTask(function(){G.__createTask=null;WebSocket.__flash.create(G.__id,C,E,D||null,F||0,B||null)})},0)};WebSocket.prototype.send=function(C){if(this.readyState==WebSocket.CONNECTING){throw"INVALID_STATE_ERR: Web Socket connection has not been established"}var B=WebSocket.__flash.send(this.__id,encodeURIComponent(C));if(B<0){return true}else{this.bufferedAmount+=B;return false}};WebSocket.prototype.close=function(){if(this.__createTask){clearTimeout(this.__createTask);this.__createTask=null;this.readyState=WebSocket.CLOSED;return}if(this.readyState==WebSocket.CLOSED||this.readyState==WebSocket.CLOSING){return}this.readyState=WebSocket.CLOSING;WebSocket.__flash.close(this.__id)};WebSocket.prototype.addEventListener=function(B,C,D){if(!(B in this.__events)){this.__events[B]=[]}this.__events[B].push(C)};WebSocket.prototype.removeEventListener=function(B,D,F){if(!(B in this.__events)){return}var E=this.__events[B];for(var C=E.length-1;C>=0;--C){if(E[C]===D){E.splice(C,1);break}}};WebSocket.prototype.dispatchEvent=function(D){var E=this.__events[D.type]||[];for(var B=0;B<E.length;++B){E[B](D)}var C=this["on"+D.type];if(C){C.apply(this,[D])}};WebSocket.prototype.__handleEvent=function(C){if("readyState" in C){this.readyState=C.readyState}if("protocol" in C){this.protocol=C.protocol}var D;if(C.type=="open"||C.type=="error"){D=this.__createSimpleEvent(C.type)}else{if(C.type=="close"){D=this.__createSimpleEvent("close");D.wasClean=C.wasClean?true:false;D.code=C.code;D.reason=C.reason}else{if(C.type=="message"){var B=decodeURIComponent(C.message);D=this.__createMessageEvent("message",B)}else{throw"unknown event type: "+C.type}}}this.dispatchEvent(D)};WebSocket.prototype.__createSimpleEvent=function(B){if(document.createEvent&&window.Event){var C=document.createEvent("Event");C.initEvent(B,false,false);return C}else{return{type:B,bubbles:false,cancelable:false}}};WebSocket.prototype.__createMessageEvent=function(B,D){if(document.createEvent&&window.MessageEvent&&!window.opera){var C=document.createEvent("MessageEvent");C.initMessageEvent("message",false,false,D,null,null,window,null);return C}else{return{type:B,data:D,bubbles:false,cancelable:false}}};WebSocket.CONNECTING=0;WebSocket.OPEN=1;WebSocket.CLOSING=2;WebSocket.CLOSED=3;WebSocket.__initialized=false;WebSocket.__flash=null;WebSocket.__instances={};WebSocket.__tasks=[];WebSocket.__nextId=0;WebSocket.loadFlashPolicyFile=function(B){WebSocket.__addTask(function(){WebSocket.__flash.loadManualPolicyFile(B)})};WebSocket.__initialize=function(){if(WebSocket.__initialized){return}WebSocket.__initialized=true;if(WebSocket.__swfLocation){window.WEB_SOCKET_SWF_LOCATION=WebSocket.__swfLocation}if(!window.WEB_SOCKET_SWF_LOCATION){A.error("[WebSocket] set WEB_SOCKET_SWF_LOCATION to location of WebSocketMain.swf");return}if(!window.WEB_SOCKET_SUPPRESS_CROSS_DOMAIN_SWF_ERROR&&!WEB_SOCKET_SWF_LOCATION.match(/(^|\/)WebSocketMainInsecure\.swf(\?.*)?$/)&&WEB_SOCKET_SWF_LOCATION.match(/^\w+:\/\/([^\/]+)/)){var D=RegExp.$1;if(location.host!=D){A.error("[WebSocket] You must host HTML and WebSocketMain.swf in the same host ('"+location.host+"' != '"+D+"'). See also 'How to host HTML file and SWF file in different domains' section in README.md. If you use WebSocketMainInsecure.swf, you can suppress this message by WEB_SOCKET_SUPPRESS_CROSS_DOMAIN_SWF_ERROR = true;")}}var B=document.createElement("div");B.id="webSocketContainer";B.style.position="absolute";if(WebSocket.__isFlashLite()){B.style.left="0px";B.style.top="0px"}else{B.style.left="-100px";B.style.top="-100px"}var C=document.createElement("div");C.id="webSocketFlash";B.appendChild(C);document.body.appendChild(B);swfobject.embedSWF(WEB_SOCKET_SWF_LOCATION,"webSocketFlash","1","1","10.0.0",null,null,{hasPriority:true,swliveconnect:true,allowScriptAccess:"always"},null,function(E){if(!E.success){A.error("[WebSocket] swfobject.embedSWF failed")}})};WebSocket.__onFlashInitialized=function(){setTimeout(function(){WebSocket.__flash=document.getElementById("webSocketFlash");WebSocket.__flash.setCallerUrl(location.href);WebSocket.__flash.setDebug(!!window.WEB_SOCKET_DEBUG);for(var B=0;B<WebSocket.__tasks.length;++B){WebSocket.__tasks[B]()}WebSocket.__tasks=[]},0)};WebSocket.__onFlashEvent=function(){setTimeout(function(){try{var D=WebSocket.__flash.receiveEvents();for(var B=0;B<D.length;++B){WebSocket.__instances[D[B].webSocketId].__handleEvent(D[B])}}catch(C){A.error(C)}},0);return true};WebSocket.__log=function(B){A.log(decodeURIComponent(B))};WebSocket.__error=function(B){A.error(decodeURIComponent(B))};WebSocket.__addTask=function(B){if(WebSocket.__flash){B()}else{WebSocket.__tasks.push(B)}};WebSocket.__isFlashLite=function(){if(!window.navigator||!window.navigator.mimeTypes){return false}var B=window.navigator.mimeTypes["application/x-shockwave-flash"];if(!B||!B.enabledPlugin||!B.enabledPlugin.filename){return false}return B.enabledPlugin.filename.match(/flashlite/i)?true:false};if(!window.WEB_SOCKET_DISABLE_AUTO_INITIALIZATION){swfobject.addDomLoadEvent(function(){WebSocket.__initialize()})}})()}}else{WebSocket=null}};